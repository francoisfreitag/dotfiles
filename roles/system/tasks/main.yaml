---
- name: Install dependencies
  become: yes
  pacman:
    name:
      - alacritty
      - ctags
      - direnv
      - fzf
      - git
      - git-absorb
      - git-delta
      - github-cli
      - neomutt
      - neovim
      - nerd-fonts
      - notmuch-runtime
      - openssh
      - python-pynvim
      - ripgrep
      - rsync
      - thermald
      - tmux
      - tree-sitter
      - tree-sitter-cli
      - zsh
      - zsh-syntax-highlighting

- name: Make systemd environment.d
  file:
    path: ~/.config/environment.d
    state: directory

- name: Enable SSH agent
  systemd_service:
    name: ssh-agent
    scope: user
    enabled: yes

- name: Link to the SSH agent
  copy:
    content: SSH_AUTH_SOCK=$XDG_RUNTIME_DIR/ssh-agent.socket
    dest: ~/.config/environment.d/ssh_agent.conf

- name: Set restrictive umask
  become: yes
  lineinfile:
    line: UMASK		077
    path: /etc/login.defs
    regexp: '^UMASK\s+[0-9]{3}$'

- import_tasks: yay.yaml
